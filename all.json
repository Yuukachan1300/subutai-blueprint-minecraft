[
    {
        "hosts": "mcs",
        "remote_user": "root",
        "tasks": [
            {
                "name": "apt-update",
                "apt": {
                    "update_cache": "yes",
                    "allow_unauthenticated": "yes",
                    "upgrade": "yes"
                }
            },
            {
                "name": "install openjdk",
                "apt": {
                    "name": "openjdk-9-jre",
                    "allow_unauthenticated": "yes",
                    "update_cache": "no", 
                    "state": "present"
                }
            }, 
            {
                "name": "make sure /usr/local/minecraft exists", 
                "file": {
                    "path": "/usr/local/minecraft",
                    "recurse": "yes",
                    "state": "directory"
                }
            }, 
            {
                "name": "download minecraft server", 
                "get_url": {
                    "url": "https://launcher.mojang.com/mc/game/1.12.2/server/886945bfb2b978778c3a0288fd7fab09d315b25f/server.jar", 
                    "dest": "/usr/local/minecraft/server.jar"
                }
            }, 
            {
                "name": "copy server.properties",
                "template": {
                    "src": "./files/server.properties",
                    "dest": "/usr/local/minecraft/server.properties"
                }, 
                "register": "config"
            },
            {
                "name": "copy eula.txt",
                "template": {
                    "src": "./files/eula.txt",
                    "dest": "/usr/local/minecraft/eula.txt"
                }
            },
            {
                "name": "copy minecraft.service",
                "copy": {
                    "src": "./files/minecraft.service",
                    "dest": "/lib/systemd/system"
                }
            },
            {
                "name": "copy minecraft default",
                "copy": {
                    "src": "./files/minecraft.default",
                    "dest": "/etc/default/minecraft"
                }
            },
            {
                "name": "copy start_minecraf",
                "copy": {
                    "src": "./files/start_minecraft",
                    "dest": "/usr/local/sbin/start_minecraft",
                    "mode": "755"
                }
            }, 
            {
                "name": "fire up minecraft",
                "systemd": {
                    "name": "minecraft",
                    "masked": "no",
                    "enabled": "yes",
                    "state": "restarted",
                    "daemon_reload": "yes"
                }, 
                "when": "config.changed"
            }
        ]
    }
]